<!doctype html><html lang=en><head><title>How to remove all files from Git LFS quickly. :: JenkinsDev :: Into the mind of an aspiring polymathic autodidact</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Prerequisites A Git repo with files stored using Git LFS The BFG Repo Cleaner tool (requires java itself) Have a clean HEAD The BFG is a simpler, faster alternative to git-filter-branch for cleansing bad data out of your Git repository history…"><meta name=keywords content="technology coding programming software development creativity work family life everything"><meta name=robots content="noodp"><link rel=canonical href=https://jenkinsdev.us/posts/remove-all-files-from-git-lfs/><link rel=stylesheet href=https://jenkinsdev.us/assets/style.css><link rel=stylesheet href=https://jenkinsdev.us/assets/blue.css><link rel=apple-touch-icon href=https://jenkinsdev.us/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://jenkinsdev.us/img/favicon/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content="jenkinsdev.github.io"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="How to remove all files from Git LFS quickly."><meta property="og:description" content="Prerequisites A Git repo with files stored using Git LFS The BFG Repo Cleaner tool (requires java itself) Have a clean HEAD The BFG is a simpler, faster alternative to git-filter-branch for cleansing bad data out of your Git repository history…"><meta property="og:url" content="https://jenkinsdev.us/posts/remove-all-files-from-git-lfs/"><meta property="og:site_name" content="JenkinsDev :: Into the mind of an aspiring polymathic autodidact"><meta property="og:image" content="https://jenkinsdev.us/img/favicon/blue.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-09-20 00:00:00 +0000 UTC"><script async src="https://www.googletagmanager.com/gtag/js?id=G-8HW9H1ENZ4"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8HW9H1ENZ4")</script></head><body class=blue><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>JenkinsDev</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/conway.html>Conway's Game of Life (☑️ Edition)</a></li><li><a href=/notes>Public Notes</a></li><li><a href=/showcase>Showcase</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/conway.html>Conway's Game of Life (☑️ Edition)</a></li><li><a href=/notes>Public Notes</a></li><li><a href=/showcase>Showcase</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://jenkinsdev.us/posts/remove-all-files-from-git-lfs/>How to remove all files from Git LFS quickly.</a></h1><div class=post-meta><span class=post-date>2022-09-20
</span><span class=post-reading-time>:: 1 min read (173 words)</span></div><span class=post-tags>#<a href=https://jenkinsdev.us/tags/git/>git</a>&nbsp;
#<a href=https://jenkinsdev.us/tags/lfs/>lfs</a>&nbsp;</span><div class=post-content><div><h1 id=prerequisites>Prerequisites<a href=#prerequisites class=hanchor arialabel=Anchor>&#8983;</a></h1><ol><li>A Git repo with files stored using <a href=https://git-lfs.github.com/>Git LFS</a></li><li>The <a href=https://rtyley.github.io/bfg-repo-cleaner/>BFG Repo Cleaner</a> tool (requires java itself)</li><li>Have a clean <a href=https://git-scm.com/book/en/v2/Git-Internals-Git-References#ref_the_ref>HEAD</a></li></ol><blockquote><p>The BFG is a simpler, faster alternative to git-filter-branch for cleansing bad data out of your Git repository history&mldr;</p></blockquote><h1 id=the-one-liner>The One-Liner<a href=#the-one-liner class=hanchor arialabel=Anchor>&#8983;</a></h1><pre tabindex=0><code>git lfs ls-files --all | awk &#39;{split($0,a,&#34; - &#34;);l=split(a[2],b,&#34;/&#34;); print b[l]}&#39; | xargs -d\\n -n1 java -jar ../bfg.jar -D &amp;&amp; \
    git reflog expire --expire=now --all &amp;&amp; \
    git gc --prune=now --aggressive
</code></pre><h1 id=whats-happening>What&rsquo;s Happening?<a href=#whats-happening class=hanchor arialabel=Anchor>&#8983;</a></h1><ol><li><code>git lfs ls-files --all</code> -> list all files & hashes</li><li><code>awk '{split($0,a," - ");l=split(a[2],b,"/"); print b[l]}'</code> -> split the data to only get file names, since bfg does not work with paths</li><li><code>xargs -d\\n -n1 java -jar ../bfg.jar -D</code> -> for each file emitted by awk, run bfg with <code>--delete-files/-D</code> (removes the file)</li><li><code>git reflog expire --expire=now --all</code> -> The &ldquo;expire&rdquo; subcommand prunes old reflog entries.</li><li><code>git gc --prune=now --aggressive</code> -> <a href=https://git-scm.com/docs/git-gc><code>git-gc</code></a> cleans up unnecessary files and optimizes the local repository. <code>--prune=now</code> prunes loose objects older than now (all loose), <code>--aggressive</code> forces <code>git-gc</code> to optimize &ldquo;heavier&rdquo;.</li></ol></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://jenkinsdev.us/posts/http-strict-transport-security-and-preloading/><span class=button__text>HTTP Strict Transport Security (HSTS) & Preloading</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer></footer><script src=https://jenkinsdev.us/assets/main.js></script><script src=https://jenkinsdev.us/assets/prism.js></script></div></body></html>